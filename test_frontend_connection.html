<!DOCTYPE html>
<html>
<head>
    <title>Frontend-Backend Connection Test</title>
</head>
<body>
    <h1>PriceOptima Frontend-Backend Test</h1>
    <div id="status">Testing connection...</div>
    <div id="results"></div>

    <script>
        async function testConnection() {
            const statusDiv = document.getElementById('status');
            const resultsDiv = document.getElementById('results');
            
            try {
                // Test backend health
                const healthResponse = await fetch('http://127.0.0.1:8001/health');
                const healthData = await healthResponse.json();
                
                statusDiv.innerHTML = '‚úÖ Backend Health: ' + healthData.status;
                resultsDiv.innerHTML += '<p>Backend Health Response: ' + JSON.stringify(healthData) + '</p>';
                
                // Test file upload
                const formData = new FormData();
                const csvContent = 'product,price,quantity,revenue\nTest,10,5,50';
                const blob = new Blob([csvContent], { type: 'text/csv' });
                formData.append('file', blob, 'test.csv');
                
                const uploadResponse = await fetch('http://127.0.0.1:8001/upload', {
                    method: 'POST',
                    body: formData
                });
                
                const uploadData = await uploadResponse.json();
                resultsDiv.innerHTML += '<p>‚úÖ Upload Test: ' + uploadData.message + '</p>';
                
                // Test EDA
                const edaResponse = await fetch('http://127.0.0.1:8001/eda', {
                    method: 'POST'
                });
                const edaData = await edaResponse.json();
                resultsDiv.innerHTML += '<p>‚úÖ EDA Test: Completed with ' + edaData.summary_stats.total_records + ' records</p>';
                
                // Test RL
                const rlResponse = await fetch('http://127.0.0.1:8001/rl', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ algorithm: 'dqn' })
                });
                const rlData = await rlResponse.json();
                resultsDiv.innerHTML += '<p>‚úÖ RL Test: Final reward ' + rlData.finalReward.toFixed(2) + '</p>';
                
                statusDiv.innerHTML = 'üéâ All tests passed! Frontend-Backend connection is working perfectly.';
                
            } catch (error) {
                statusDiv.innerHTML = '‚ùå Connection failed: ' + error.message;
                resultsDiv.innerHTML += '<p>Error: ' + error.message + '</p>';
            }
        }
        
        // Run test when page loads
        window.onload = testConnection;
    </script>
</body>
</html>
